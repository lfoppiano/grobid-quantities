Loading data...
2243 train sequences
250 validation sequences
278 evaluation sequences
embedding_lmdb_path is not specified in the embeddings registry, so the embeddings will be loaded in memory...
loading embeddings...
path: /lustre/group/tdm/Luca/delft/delft/data/embeddings/glove.840B.300d.txt
embeddings loaded for 2196017 words and 300 dimensions
Output directory: data/models/sequenceLabelling/units-BidLSTM_CRF
---
max_epoch: 60
early_stop: True
batch_size: 20
max_sequence_length: 3000
model_name: units-BidLSTM_CRF
learning_rate:  0.001
use_ELMo:  False
---
Model: "model"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 char_input (InputLayer)        [(None, None, 30)]   0           []                               
                                                                                                  
 time_distributed (TimeDistribu  (None, None, 30, 25  1850       ['char_input[0][0]']             
 ted)                           )                                                                 
                                                                                                  
 word_input (InputLayer)        [(None, None, 300)]  0           []                               
                                                                                                  
 time_distributed_1 (TimeDistri  (None, None, 50)    10200       ['time_distributed[0][0]']       
 buted)                                                                                           
                                                                                                  
 concatenate (Concatenate)      (None, None, 350)    0           ['word_input[0][0]',             
                                                                  'time_distributed_1[0][0]']     
                                                                                                  
 dropout (Dropout)              (None, None, 350)    0           ['concatenate[0][0]']            
                                                                                                  
 bidirectional_1 (Bidirectional  (None, None, 200)   360800      ['dropout[0][0]']                
 )                                                                                                
                                                                                                  
 dropout_1 (Dropout)            (None, None, 200)    0           ['bidirectional_1[0][0]']        
                                                                                                  
 length_input (InputLayer)      [(None, 1)]          0           []                               
                                                                                                  
 dense (Dense)                  (None, None, 100)    20100       ['dropout_1[0][0]']              
                                                                                                  
==================================================================================================
Total params: 392,950
Trainable params: 392,950
Non-trainable params: 0
__________________________________________________________________________________________________
Model: "crf_model_wrapper_default"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 crf (CRF)                   multiple                  770       
                                                                 
 model (Functional)          (None, None, 100)         392950    
                                                                 
=================================================================
Total params: 393,720
Trainable params: 393,720
Non-trainable params: 0
_________________________________________________________________

[...]
training runtime: 2409.647 seconds 

Evaluation:
Model: "model"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 char_input (InputLayer)        [(None, None, 30)]   0           []                               
                                                                                                  
 time_distributed (TimeDistribu  (None, None, 30, 25  1850       ['char_input[0][0]']             
 ted)                           )                                                                 
                                                                                                  
 word_input (InputLayer)        [(None, None, 300)]  0           []                               
                                                                                                  
 time_distributed_1 (TimeDistri  (None, None, 50)    10200       ['time_distributed[0][0]']       
 buted)                                                                                           
                                                                                                  
 concatenate (Concatenate)      (None, None, 350)    0           ['word_input[0][0]',             
                                                                  'time_distributed_1[0][0]']     
                                                                                                  
 dropout (Dropout)              (None, None, 350)    0           ['concatenate[0][0]']            
                                                                                                  
 bidirectional_1 (Bidirectional  (None, None, 200)   360800      ['dropout[0][0]']                
 )                                                                                                
                                                                                                  
 dropout_1 (Dropout)            (None, None, 200)    0           ['bidirectional_1[0][0]']        
                                                                                                  
 length_input (InputLayer)      [(None, 1)]          0           []                               
                                                                                                  
 dense (Dense)                  (None, None, 100)    20100       ['dropout_1[0][0]']              
                                                                                                  
==================================================================================================
Total params: 392,950
Trainable params: 392,950
Non-trainable params: 0
__________________________________________________________________________________________________
Model: "crf_model_wrapper_default"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 crf (CRF)                   multiple                  770       
                                                                 
 model (Functional)          (None, None, 100)         392950    
                                                                 
=================================================================
Total params: 393,720
Trainable params: 393,720
Non-trainable params: 0
_________________________________________________________________
---
max_epoch: 60
early_stop: True
batch_size: 20
max_sequence_length: 3000
model_name: units-BidLSTM_CRF
learning_rate:  0.001
use_ELMo:  False
---

------------------------ fold 0 --------------------------------------
	f1 (micro): 97.56
                  precision    recall  f1-score   support

          <base>     0.9767    0.9671    0.9719       304
           <pow>     1.0000    1.0000    1.0000        35
        <prefix>     0.9722    0.9859    0.9790        71

all (micro avg.)     0.9779    0.9732    0.9756       410


------------------------ fold 1 --------------------------------------
	f1 (micro): 98.54
                  precision    recall  f1-score   support

          <base>     0.9868    0.9836    0.9852       304
           <pow>     1.0000    1.0000    1.0000        35
        <prefix>     0.9722    0.9859    0.9790        71

all (micro avg.)     0.9854    0.9854    0.9854       410


------------------------ fold 2 --------------------------------------
	f1 (micro): 97.68
                  precision    recall  f1-score   support

          <base>     0.9769    0.9737    0.9753       304
           <pow>     1.0000    0.9714    0.9855        35
        <prefix>     0.9722    0.9859    0.9790        71

all (micro avg.)     0.9780    0.9756    0.9768       410


------------------------ fold 3 --------------------------------------
	f1 (micro): 98.04
                  precision    recall  f1-score   support

          <base>     0.9770    0.9770    0.9770       304
           <pow>     1.0000    1.0000    1.0000        35
        <prefix>     1.0000    0.9718    0.9857        71

all (micro avg.)     0.9828    0.9780    0.9804       410


------------------------ fold 4 --------------------------------------
	f1 (micro): 98.41
                  precision    recall  f1-score   support

          <base>     0.9804    0.9868    0.9836       304
           <pow>     1.0000    0.9714    0.9855        35
        <prefix>     1.0000    0.9718    0.9857        71

all (micro avg.)     0.9853    0.9829    0.9841       410


------------------------ fold 5 --------------------------------------
	f1 (micro): 98.42
                  precision    recall  f1-score   support

          <base>     0.9772    0.9868    0.9820       304
           <pow>     1.0000    1.0000    1.0000        35
        <prefix>     1.0000    0.9718    0.9857        71

all (micro avg.)     0.9830    0.9854    0.9842       410


------------------------ fold 6 --------------------------------------
	f1 (micro): 98.17
                  precision    recall  f1-score   support

          <base>     0.9834    0.9770    0.9802       304
           <pow>     1.0000    1.0000    1.0000        35
        <prefix>     0.9722    0.9859    0.9790        71

all (micro avg.)     0.9829    0.9805    0.9817       410


------------------------ fold 7 --------------------------------------
	f1 (micro): 97.93
                  precision    recall  f1-score   support

          <base>     0.9770    0.9770    0.9770       304
           <pow>     1.0000    1.0000    1.0000        35
        <prefix>     0.9722    0.9859    0.9790        71

all (micro avg.)     0.9781    0.9805    0.9793       410


------------------------ fold 8 --------------------------------------
	f1 (micro): 98.04
                  precision    recall  f1-score   support

          <base>     0.9834    0.9737    0.9785       304
           <pow>     1.0000    1.0000    1.0000        35
        <prefix>     0.9722    0.9859    0.9790        71

all (micro avg.)     0.9828    0.9780    0.9804       410


------------------------ fold 9 --------------------------------------
	f1 (micro): 98.66
                  precision    recall  f1-score   support

          <base>     0.9901    0.9836    0.9868       304
           <pow>     1.0000    1.0000    1.0000        35
        <prefix>     0.9722    0.9859    0.9790        71

all (micro avg.)     0.9878    0.9854    0.9866       410

----------------------------------------------------------------------

** Worst ** model scores - run 0
                  precision    recall  f1-score   support

          <base>     0.9767    0.9671    0.9719       304
           <pow>     1.0000    1.0000    1.0000        35
        <prefix>     0.9722    0.9859    0.9790        71

all (micro avg.)     0.9779    0.9732    0.9756       410


** Best ** model scores - run 9
                  precision    recall  f1-score   support

          <base>     0.9901    0.9836    0.9868       304
           <pow>     1.0000    1.0000    1.0000        35
        <prefix>     0.9722    0.9859    0.9790        71

all (micro avg.)     0.9878    0.9854    0.9866       410

----------------------------------------------------------------------

Average over 10 folds
                  precision    recall  f1-score   support

          <base>     0.9809    0.9786    0.9797       304
           <pow>     1.0000    0.9943    0.9971        35
        <prefix>     0.9806    0.9817    0.9810        71

all (micro avg.)     0.9824    0.9805    0.9814          

model config file saved
preprocessor saved
model saved
